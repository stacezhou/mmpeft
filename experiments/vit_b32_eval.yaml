search_space:
  _dataset:
    - _name: dtd
      val_dataloader.dataset.data_root: 
        - data/dtd/images/test
      train_dataloader.dataset.data_root:
        - data/dtd/images/fewshot_train16_A
        - data/dtd/images/fewshot_train16_B
        - data/dtd/images/fewshot_train16_C
        - data/dtd/images/fewshot_train1_A
        - data/dtd/images/fewshot_train1_B
        - data/dtd/images/fewshot_train1_C
        - data/dtd/images/fewshot_train4_A
        - data/dtd/images/fewshot_train4_B
        - data/dtd/images/fewshot_train4_C
        - data/dtd/images/train

  model.peft:
    - _name: Empty # full model finetune
    - _name: LoRA
      type: LoRA
      pattern: visual
      rank: 
        - 2
        - 8
        - 64
        - 128
      scale: 
        - 2
        - 8
        - 64
        - 128

  randomness.seed:
    - 1
    - 10
    - 100

  optim_wrapper.optimizer.lr:
    - 0.0001
    - 0.005
    - 0.001

  train_dataloader.batch_size:
    - 128
    - 256

trial_command: >
  python tools/train.py myconfigs/clip_vit_b33.py 
  --work_dir work_dirs/vitb32_eval
  --cfg-options 
    load_from=data/clip-ViT-B-32.pth 
    default_hooks.checkpoint.interval=-1 
    default_hooks.checkpoint.save_last=True

trial_code_directory: /home/zh21/mmpretrain
trial_gpu_number: 1
trial_concurrency: 4

tuner:
  name: GridSearch
  class_args:
    optimize_mode: maximize

training_service:
  platform: local
  gpuIndices: [0,1,2,3]
  use_active_gpu: false